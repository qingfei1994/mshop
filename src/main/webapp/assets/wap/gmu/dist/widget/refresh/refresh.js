(function(e,t,n){e.define("Refresh",{options:{load:null,statechange:null},_init:function(){var e=this,n=e._options;e.on("ready",function(){t.each(["up","down"],function(t,r){var i=n["$"+r+"Elem"],s=i.get(0);if(i.length){e._status(r,!0);if(!s.childNodes.length||i.find(".ui-refresh-icon").length&&i.find(".ui-refresh-label").length)!s.childNodes.length&&e._createBtn(r),n.refreshInfo||(n.refreshInfo={}),n.refreshInfo[r]={$icon:i.find(".ui-refresh-icon"),$label:i.find(".ui-refresh-label"),text:i.find(".ui-refresh-label").html()};i.on("click",function(){if(!e._status(r)||n._actDir)return;e._setStyle(r,"loading"),e._loadingAction(r,"click")})}})}),e.on("destroy",function(){e.$el.remove()})},_create:function(){var e=this,t=e._options,n=e.$el;e._options.setup&&(t.$upElem=n.find(".ui-refresh-up"),t.$downElem=n.find(".ui-refresh-down"),n.addClass("ui-refresh"))},_createBtn:function(e){return this._options["$"+e+"Elem"].html('<span class="ui-refresh-icon"></span><span class="ui-refresh-label">加载更多</span>'),this},_setStyle:function(e,n){var r=this,i=t.Event("statechange");return r.trigger(i,r._options["$"+e+"Elem"],n,e),i.defaultPrevented?r:r._changeStyle(e,n)},_changeStyle:function(e,t){var n=this._options,r=n.refreshInfo[e];switch(t){case"loaded":r.$label.html(r.text),r.$icon.removeClass(),n._actDir="";break;case"loading":r.$label.html("正在加载，请稍候..."),r.$icon.addClass("ui-loading"),n._actDir=e;break;case"disable":r.$label.html("没有更多了")}return this},_loadingAction:function(e,n){var r=this,i=r._options,s=i.load;return t.isFunction(s)&&s.call(r,e,n),r._status(e,!1),r},afterDataLoading:function(e){var t=this,e=e||t._options._actDir;return t._setStyle(e,"loaded"),t._status(e,!0),t},_status:function(e,t){var r=this._options;return t===n?r["_"+e+"Open"]:r["_"+e+"Open"]=!!t},_setable:function(e,n,r){var i=this,s=i._options,o=n?[n]:["up","down"];return t.each(o,function(t,n){var o=s["$"+n+"Elem"];if(!o.length)return;e?o.show():r?o.hide():i._setStyle(n,"disable"),i._status(n,e)}),i},disable:function(e,t){return this._setable(!1,e,t)},enable:function(e){return this._setable(!0,e)}})})(gmu,gmu.$);