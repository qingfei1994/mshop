(function(e,t,n){var r=["01月","02月","03月","04月","05月","06月","07月","08月","09月","10月","11月","12月"],i=["日","一","二","三","四","五","六"],s=/^(\+|\-)?(\d+)(M|Y)$/i,o=function(e,t){return 32-(new Date(e,t,32)).getDate()},u=function(e,t){return(new Date(e,t,1)).getDay()},a=function(e,t){var n=""+e;while(n.length<t)n="0"+n;return n},f=function(e){return e.is("select, input")?e.val():e.attr("data-value")},l;e.define("Calendar",{options:{date:null,firstDay:1,maxDate:null,minDate:null,swipeable:!1,monthChangeable:!1,yearChangeable:!1},_init:function(){this.on("ready",function(){var e=this._options,n=this._container||this.$el,r=t.proxy(this._eventHandler,this);this.minDate(e.minDate).maxDate(e.maxDate).date(e.date||new Date).refresh(),n.addClass("ui-calendar").on("click",r).highlight(),e.swipeable&&n.on("swipeLeft swipeRight",r)})},_create:function(){var e=this.$el;e||(e=this.$el=t("<div>")),e.appendTo(this._options.container||(e.parent().length?"":document.body))},_eventHandler:function(e){var n=this._options,r=(this._container||this.$el).get(0),i,s,o,u,a;switch(e.type){case"swipeLeft":case"swipeRight":return this.switchMonthTo((e.type=="swipeRight"?"-":"+")+"1M");case"change":return a=t(".ui-calendar-header .ui-calendar-year, .ui-calendar-header .ui-calendar-month",this._el),this.switchMonthTo(f(a.eq(1)),f(a.eq(0)));default:s=e.target,(i=t(s).closest(".ui-calendar-calendar tbody a",r))&&i.length?(e.preventDefault(),o=i.parent(),this._option("selectedDate",u=new Date(o.attr("data-year"),o.attr("data-month"),i.text())),this.trigger("select",u,t.calendar.formatDate(u),this),this.refresh()):(i=t(s).closest(".ui-calendar-prev, .ui-calendar-next",r))&&i.length&&(e.preventDefault(),this.switchMonthTo((i.is(".ui-calendar-prev")?"-":"+")+"1M"))}},_option:function(e,r){var i=this._options,s,o,u;if(r!==n){switch(e){case"minDate":case"maxDate":i[e]=r?t.calendar.parseDate(r):null;break;case"selectedDate":o=i.minDate,u=i.maxDate,r=t.calendar.parseDate(r),r=o&&o>r?o:u&&u<r?u:r,i._selectedYear=i._drawYear=r.getFullYear(),i._selectedMonth=i._drawMonth=r.getMonth(),i._selectedDay=r.getDate();break;case"date":this._option("selectedDate",r),i[e]=this._option("selectedDate");break;default:i[e]=r}return i._invalid=!0,this}return e=="selectedDate"?new Date(i._selectedYear,i._selectedMonth,i._selectedDay):i[e]},switchToToday:function(){var e=new Date;return this.switchMonthTo(e.getMonth(),e.getFullYear())},switchMonthTo:function(e,t){var n=this._options,r=this.minDate(),i=this.maxDate(),o,u,a;Object.prototype.toString.call(e)==="[object String]"&&s.test(e)?(o=RegExp.$1=="-"?-parseInt(RegExp.$2,10):parseInt(RegExp.$2,10),u=RegExp.$3.toLowerCase(),e=n._drawMonth+(u=="m"?o:0),t=n._drawYear+(u=="y"?o:0)):(e=parseInt(e,10),t=parseInt(t,10)),a=new Date(t,e,1),a=r&&r>a?r:i&&i<a?i:a,e=a.getMonth(),t=a.getFullYear();if(e!=n._drawMonth||t!=n._drawYear)this.trigger("monthchange",n._drawMonth=e,n._drawYear=t,this),n._invalid=!0,this.refresh();return this},refresh:function(){var e=this._options,n=this._container||this.$el,r=t.proxy(this._eventHandler,this);if(!e._invalid)return;return t(".ui-calendar-calendar td:not(.ui-state-disabled), .ui-calendar-header a",n).highlight(),t(".ui-calendar-header select",n).off("change",r),n.empty().append(this._generateHTML()),t(".ui-calendar-calendar td:not(.ui-state-disabled), .ui-calendar-header a",n).highlight("ui-state-hover"),t(".ui-calendar-header select",n).on("change",r),e._invalid=!1,this},destroy:function(){var e=this._container||this.$el,n=this._eventHandler;return t(".ui-calendar-calendar td:not(.ui-state-disabled)",e).highlight(),t(".ui-calendar-header select",e).off("change",n),e.remove(),this.$super("destroy")},_generateHTML:function(){var e=this._options,t=e._drawYear,n=e._drawMonth,r=new Date,s=new Date(r.getFullYear(),r.getMonth(),r.getDate()),a=this.minDate(),f=this.maxDate(),l=this.selectedDate(),c="",h,p,d,v,m,g,y,b;d=isNaN(d=parseInt(e.firstDay,10))?0:d,c+=this._renderHead(e,t,n,a,f)+'<table  class="ui-calendar-calendar"><thead><tr>';for(h=0;h<7;h++)v=(h+d)%7,c+="<th"+((h+d+6)%7>=5?' class="ui-calendar-week-end"':"")+">"+"<span>"+i[v]+"</span></th>";c+='</thead></tr><tbody><tr class="ui-calendar-gap"><td colspan="7">&#xa0;</td></tr>',g=o(t,n),m=(u(t,n)-d+7)%7,y=Math.ceil((m+g)/7),b=new Date(t,n,1-m);for(h=0;h<y;h++){c+="<tr>";for(p=0;p<7;p++)c+=this._renderDay(p,b,d,n,l,s,a,f),b.setDate(b.getDate()+1);c+="</tr>"}return c+="</tbody></table>",c},_renderHead:function(e,t,n,i,s){var o='<div class="ui-calendar-header">',u=new Date(t,n,-1),a=new Date(t,n+1,1),f,l;o+='<a class="ui-calendar-prev'+(i&&i>u?" ui-state-disable":"")+'" href="#">&lt;&lt;</a><div class="ui-calendar-title">';if(e.yearChangeable){o+='<select class="ui-calendar-year">';for(f=Math.max(1970,t-10),l=f+20;f<l;f++)o+='<option value="'+f+'" '+(f==t?'selected="selected"':"")+">"+f+"年</option>";o+="</select>"}else o+='<span class="ui-calendar-year" data-value="'+t+'">'+t+"年"+"</span>";if(e.monthChangeable){o+='<select class="ui-calendar-month">';for(f=0;f<12;f++)o+='<option value="'+f+'" '+(f==n?'selected="selected"':"")+">"+r[f]+"</option>";o+="</select>"}else o+='<span class="ui-calendar-month" data-value="'+n+'">'+r[n]+"</span>";return o+='</div><a class="ui-calendar-next'+(s&&s<a?" ui-state-disable":"")+'" href="#">&gt;&gt;</a></div>',o},_renderDay:function(e,t,n,r,i,s,o,u){var a=t.getMonth()!==r,f;return f=a||o&&t<o||u&&t>u,"<td class='"+((e+n+6)%7>=5?"ui-calendar-week-end":"")+(f?" ui-calendar-unSelectable ui-state-disabled":"")+(a||f?"":(t.getTime()===i.getTime()?" ui-calendar-current-day":"")+(t.getTime()===s.getTime()?" ui-calendar-today":""))+"'"+(f?"":" data-month='"+t.getMonth()+"' data-year='"+t.getFullYear()+"'")+">"+(a?"&#xa0;":f?"<span class='ui-state-default'>"+t.getDate()+"</span>":"<a class='ui-state-default"+(t.getTime()===s.getTime()?" ui-state-highlight":"")+(t.getTime()===i.getTime()?" ui-state-active":"")+"' href='#'>"+t.getDate()+"</a>")+"</td>"}}),l=e.Calendar.prototype,t.each(["maxDate","minDate","date","selectedDate"],function(e,t){l[t]=function(e){return this._option(t,e)}}),t.calendar={parseDate:function(e){var t=/^(\d{4})(?:\-|\/)(\d{1,2})(?:\-|\/)(\d{1,2})$/;return Object.prototype.toString.call(e)==="[object Date]"?e:t.test(e)?new Date(parseInt(RegExp.$1,10),parseInt(RegExp.$2,10)-1,parseInt(RegExp.$3,10)):null},formatDate:function(e){return e.getFullYear()+"-"+a(e.getMonth()+1,2)+"-"+a(e.getDate(),2)}}})(gmu,gmu.$);