(function(e,t){var n=/^#.+$/,r={},i={loading:'<div class="ui-loading">Loading</div>',error:'<p class="ui-load-error">内容加载失败!</p>'};gmu.Tabs.register("ajax",{_init:function(){var e=this._options,t,r,i;this.on("ready",function(){t=e.items;for(r=0,i=t.length;r<i;r++)t[r].href&&!n.test(t[r].href)&&(t[r].isAjax=!0);this.on("activate",this._onActivate),t[e.active].isAjax&&this.load(e.active)})},destroy:function(){return this.off("activate",this._onActivate),this.xhr&&this.xhr.abort(),this.origin()},_fitToContent:function(e){var t=this._options;if(!t._fitLock)return this.origin(e)},_onActivate:function(e,t){t.isAjax&&this.load(t.index)},load:function(t,n){var s=this,o=s._options,u=o.items,a,f,l;if(t<0||t>u.length-1||!(a=u[t])||!a.isAjax||(f=s._getPanel(t)).text()&&!n&&r[t])return this;(l=s.xhr)&&setTimeout(function(){l.abort()},400),o._loadingTimer=setTimeout(function(){f.html(i.loading)},50),o._fitLock=!0,s.xhr=e.ajax(e.extend(o.ajax||{},{url:a.href,context:s.$el.get(0),beforeSend:function(e,t){var n=gmu.Event("beforeLoad");s.trigger(n,e,t);if(n.isDefaultPrevented())return!1},success:function(e,n){var i=gmu.Event("beforeRender");clearTimeout(o._loadingTimer),s.trigger(i,e,f,t,n),i.isDefaultPrevented()||f.html(e),o._fitLock=!1,r[t]=!0,s.trigger("load",f),delete s.xhr,s._fitToContent(f)},error:function(){var e=gmu.Event("loadError");clearTimeout(o._loadingTimer),r[t]=!1,s.trigger(e,f),e.isDefaultPrevented()||f.html(i.error),delete s.xhr}}))}})})(Zepto);